<!-- board.component.html -->
<div class="board-container">
    <canvas #canvas 
    [ngClass]="{
      'cursor-tool': currentTool === 'cursor',
      'pen-tool': currentTool === 'pen',
      'eraser-tool': currentTool === 'eraser'
    }"
    (mousedown)="onMouseDown($event)" 
    (mousemove)="onMouseMove($event)" 
    (mouseup)="onMouseUp()" 
    (mouseleave)="onMouseUp()">
  </canvas>
    
    <!-- Hidden file input for image uploads -->
    <input type="file" #imageInput style="display:none" 
           accept="image/*" (change)="onImageSelected($event)">
    
    <div #toolbox class="toolbox" [class.hidden]="!isToolboxVisible">
      <div class="toolbox-header">
        <h3>Whiteboard Tools</h3>
        <button class="minimize-btn" (click)="minimizeToolbox()" title="Minimize">
          <svg viewBox="0 0 24 24" width="24" height="24">
            <path d="M19,13H5V11H19V13Z" />
          </svg>
        </button>
      </div>
      
      <div class="toolbox-section">
        <h4>Drawing Tools</h4>
        <div class="tool-buttons">
          <button [class.active]="currentTool === 'cursor'" (click)="setTool('cursor')" title="Select/Move">
            <svg viewBox="0 0 24 24" width="24" height="24">
              <path d="M13.64,21.97C13.14,22.21 12.54,22 12.31,21.5L10.13,16.76L7.62,18.78C7.45,18.92 7.24,19 7,19A1,1 0 0,1 6,18V3A1,1 0 0,1 7,2C7.24,2 7.47,2.09 7.64,2.23L7.65,2.22L19.14,11.86C19.57,12.22 19.62,12.85 19.27,13.27C19.12,13.45 18.91,13.57 18.7,13.61L15.54,14.23L17.74,18.96C18,19.46 17.76,20.05 17.26,20.28L13.64,21.97Z"/>
            </svg>
          </button>
          <button [class.active]="currentTool === 'pen'" (click)="setTool('pen')" title="Pen">
            <svg viewBox="0 0 24 24" width="24" height="24">
              <path d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"/>
            </svg>
          </button>
          <button [class.active]="currentTool === 'eraser'" (click)="setTool('eraser')" title="Eraser">
            <svg viewBox="0 0 24 24" width="24" height="24">
              <path d="M15.14 3c-.51 0-1.02.2-1.41.59L2.59 14.73c-.78.77-.78 2.04 0 2.83L5.03 20h7.66l8.72-8.72c.78-.78.78-2.05 0-2.83l-4.55-4.55c-.39-.39-.9-.59-1.41-.59M6.74 18L3.7 14.97 12 6.69l3.19 3.19L6.74 18"/>
            </svg>
          </button>
          <button (click)="triggerImageUpload()" title="Add Image">
            <svg viewBox="0 0 24 24" width="24" height="24">
              <path d="M19,19H5V5H19M19,3H5A2,2 0 0,0 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V5A2,2 0 0,0 19,3M13.96,12.29L11.21,15.83L9.25,13.47L6.5,17H17.5L13.96,12.29Z"/>
            </svg>
          </button>
        </div>
      </div>
      
      <div class="toolbox-section">
        <h4>Colors</h4>
        <div class="color-picker">
          <div class="current-color" [style.background]="currentColor" (click)="toggleColorPicker()"></div>
          <div class="color-palette" [class.open]="isColorPickerOpen">
            <div *ngFor="let color of colors" 
                 class="color-option" 
                 [style.background]="color"
                 (click)="setColor(color)">
            </div>
          </div>
        </div>
      </div>
      
      <div class="toolbox-section">
        <h4>Line Width</h4>
        <div class="line-width-control">
          <input type="range" min="1" max="20" [value]="currentLineWidth" (input)="onLineWidthChange($event)">
          <span>{{currentLineWidth}}px</span>
        </div>
      </div>
      
      <div class="toolbox-section">
        <h4>Actions</h4>
        <div class="action-buttons">
          <button (click)="undo()" title="Undo">
            <svg viewBox="0 0 24 24" width="24" height="24">
              <path d="M12.5,8C9.85,8 7.45,9 5.6,10.6L2,7V16H11L7.38,12.38C8.77,11.22 10.54,10.5 12.5,10.5C16.04,10.5 19.05,12.81 20.1,16L22.47,15.22C21.08,11.03 17.15,8 12.5,8Z"/>
            </svg>
          </button>
          <button (click)="redo()" title="Redo">
            <svg viewBox="0 0 24 24" width="24" height="24">
              <path d="M18.4,10.6C16.55,9 14.15,8 11.5,8C6.85,8 2.92,11.03 1.54,15.22L3.9,16C4.95,12.81 7.95,10.5 11.5,10.5C13.45,10.5 15.23,11.22 16.62,12.38L13,16H22V7L18.4,10.6Z"/>
            </svg>
          </button>
          <button (click)="clearBoard()" title="Clear Board">
            <svg viewBox="0 0 24 24" width="24" height="24">
              <path d="M19,4H15.5L14.5,3H9.5L8.5,4H5V6H19M6,19A2,2 0 0,0 8,21H16A2,2 0 0,0 18,19V7H6V19Z"/>
            </svg>
          </button>
          <button (click)="saveBoard()" title="Save Board">
            <svg viewBox="0 0 24 24" width="24" height="24">
              <path d="M15,9H5V5H15M12,19A3,3 0 0,1 9,16A3,3 0 0,1 12,13A3,3 0 0,1 15,16A3,3 0 0,1 12,19M17,3H5C3.89,3 3,3.9 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V7L17,3Z"/>
            </svg>
          </button>
        </div>
      </div>
    </div>
    
    <button class="show-toolbox-btn" *ngIf="!isToolboxVisible" (click)="showToolbox()">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <path d="M3,6H21V8H3V6M3,11H21V13H3V11M3,16H21V18H3V16Z"/>
      </svg>
    </button>
  </div>