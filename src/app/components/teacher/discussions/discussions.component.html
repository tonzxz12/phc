<div class="discussions-container" [style]="{'background': 'var(--body-color)', 'color': 'var(--text-color)', 'min-height': '100vh'}">
  <!-- Header Section -->
  <div class="header-section" [style]="{'background': 'var(--card-bg)', 'border-bottom': '2px solid var(--border-color)'}">
    <div class="header-content">
      <div class="title-section">
        <h1 [style]="{'color': 'var(--text-color)'}">Discussion Management</h1>
        <p [style]="{'color': 'var(--text-muted)'}">Monitor and manage course discussions and student conversations across all your courses</p>
      </div>
    </div>
  </div>

  <!-- Loading State -->
  <div *ngIf="loading" class="loading-state">
    <div class="loading-spinner" [style]="{'border-color': 'var(--border-color)', 'border-top-color': 'var(--primary-color)'}"></div>
    <p [style]="{'color': 'var(--text-muted)'}">Loading discussions...</p>
  </div>

  <!-- Statistics Section -->
  <div *ngIf="!loading" class="stats-section">
    <div class="stats-grid">
      <div class="stat-card" [style]="{'background': 'var(--card-bg)', 'border': '1px solid var(--border-color)'}">
        <div class="stat-header">
          <div class="stat-icon" [style]="{'background': 'var(--primary-color)', 'color': 'var(--text-on-primary)'}">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24" fill="currentColor">
              <path d="M20 2H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h4l4 4 4-4h4c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2z"/>
            </svg>
          </div>
          <h3 [style]="{'color': 'var(--text-color)'}">Total Threads</h3>
        </div>
        <div class="stat-metrics">
          <div class="metric-value" [style]="{'color': 'var(--primary-color)'}">{{ totalThreads }}</div>
          <div class="metric-label" [style]="{'color': 'var(--text-muted)'}">Discussion Threads</div>
        </div>
      </div>

      <div class="stat-card" [style]="{'background': 'var(--card-bg)', 'border': '1px solid var(--border-color)'}">
        <div class="stat-header">
          <div class="stat-icon" [style]="{'background': 'var(--secondary-color)', 'color': 'white'}">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24" fill="currentColor">
              <path d="M10 9V5l-7 7 7 7v-4.1c5 0 8.5 1.6 11 5.1-1-5-4-10-11-11z"/>
            </svg>
          </div>
          <h3 [style]="{'color': 'var(--text-color)'}">Total Posts</h3>
        </div>
        <div class="stat-metrics">
          <div class="metric-value" [style]="{'color': 'var(--secondary-color)'}">{{ totalPosts }}</div>
          <div class="metric-label" [style]="{'color': 'var(--text-muted)'}">Student Posts</div>
        </div>
      </div>

      <div class="stat-card" [style]="{'background': 'var(--card-bg)', 'border': '1px solid var(--border-color)'}">
        <div class="stat-header">
          <div class="stat-icon" [style]="{'background': 'var(--warning-color)', 'color': 'white'}">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24" fill="currentColor">
              <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
            </svg>
          </div>
          <h3 [style]="{'color': 'var(--text-color)'}">Today's Posts</h3>
        </div>
        <div class="stat-metrics">
          <div class="metric-value" [style]="{'color': 'var(--warning-color)'}">{{ todaysPosts }}</div>
          <div class="metric-label" [style]="{'color': 'var(--text-muted)'}">New Today</div>
        </div>
      </div>

      <div class="stat-card" [style]="{'background': 'var(--card-bg)', 'border': '1px solid var(--border-color)'}">
        <div class="stat-header">
          <div class="stat-icon" [style]="{'background': 'var(--success-color)', 'color': 'white'}">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24" fill="currentColor">
              <path d="M16 4c0-1.11.89-2 2-2s2 .89 2 2-.89 2-2 2-2-.89-2-2zm4 18v-6h2.5l-2.54-7.63A1.5 1.5 0 0 0 18.54 7h-.79l-1.21-1.93A2 2 0 0 0 14.84 4H9.16a2 2 0 0 0-1.7 1.07L6.25 7h-.79a1.5 1.5 0 0 0-1.42 1.37L1.5 16H4v6h2v-6h12v6h2z"/>
            </svg>
          </div>
          <h3 [style]="{'color': 'var(--text-color)'}">Active Students</h3>
        </div>
        <div class="stat-metrics">
          <div class="metric-value" [style]="{'color': 'var(--success-color)'}">{{ activeStudents }}</div>
          <div class="metric-label" [style]="{'color': 'var(--text-muted)'}">Participating</div>
        </div>
      </div>
    </div>
  </div>

  <!-- Course Forums Section -->
  <div *ngIf="!loading" class="forums-section">
    <div class="section-container" [style]="{'background': 'var(--card-bg)', 'border': '1px solid var(--border-color)'}">
      <div class="section-header" [style]="{'background': 'var(--primary-color)', 'color': 'var(--text-on-primary)'}">
        <div class="section-title">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24" fill="currentColor">
            <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-5 14H7v-2h7v2zm3-4H7v-2h10v2zm0-4H7V7h10v2z"/>
          </svg>
          <span>Your Course Forums</span>
        </div>
      </div>
      
      <div class="section-content">
        <div *ngIf="teachingCourses.length === 0" class="empty-state">
          <div class="empty-icon" [style]="{'color': 'var(--text-muted)'}">ðŸ“š</div>
          <h3 [style]="{'color': 'var(--text-color)'}">No Courses Found</h3>
          <p [style]="{'color': 'var(--text-muted)'}">You are not teaching any courses yet. Create courses to enable discussions.</p>
        </div>

        <div *ngIf="teachingCourses.length > 0" class="forums-grid">
          <div *ngFor="let course of teachingCourses" class="forum-card" [style]="{'background': 'var(--card-bg)', 'border': '1px solid var(--border-color)'}">
            <div class="forum-image" [style]="{'background': 'var(--secondary-color)'}">
              <img *ngIf="course.image" [src]="getURL(course.image)" [alt]="course.course">
              <div class="forum-overlay">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="32" height="32" fill="currentColor">
                  <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-5 14H7v-2h7v2zm3-4H7v-2h10v2zm0-4H7V7h10v2z"/>
                </svg>
              </div>
            </div>
            
            <div class="forum-content">
              <h3 class="forum-title" [style]="{'color': 'var(--text-color)'}" [title]="course.course">{{ course.course }}</h3>
              
              <div class="forum-stats-grid">
                <div class="forum-stat">
                  <span [style]="{'color': 'var(--text-muted)'}">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="14" height="14" fill="currentColor">
                      <path d="M20 2H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h4l4 4 4-4h4c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2z"/>
                    </svg>
                    {{ getCourseThreadCount(course.id) }} threads
                  </span>
                </div>
                <div class="forum-stat">
                  <span [style]="{'color': 'var(--text-muted)'}">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="14" height="14" fill="currentColor">
                      <path d="M16 4c0-1.11.89-2 2-2s2 .89 2 2-.89 2-2 2-2-.89-2-2zm4 18v-6h2.5l-2.54-7.63A1.5 1.5 0 0 0 18.54 7h-.79l-1.21-1.93A2 2 0 0 0 14.84 4H9.16a2 2 0 0 0-1.7 1.07L6.25 7h-.79a1.5 1.5 0 0 0-1.42 1.37L1.5 16H4v6h2v-6h12v6h2z"/>
                    </svg>
                    {{ getCourseStudentCount(course.id) }} students
                  </span>
                </div>
                <div class="forum-stat">
                  <span [style]="{'color': 'var(--text-muted)'}">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="14" height="14" fill="currentColor">
                      <path d="M10 9V5l-7 7 7 7v-4.1c5 0 8.5 1.6 11 5.1-1-5-4-10-11-11z"/>
                    </svg>
                    {{ getCoursePostCount(course.id) }} posts
                  </span>
                </div>
                <div class="forum-stat" *ngIf="getUnreadCount(course.id) > 0">
                  <span class="new-badge" [style]="{'background': 'var(--danger-color)', 'color': 'white'}">
                    {{ getUnreadCount(course.id) }} new
                  </span>
                </div>
              </div>
              
              <div class="forum-actions">
                <button (click)="navigateToCourseForum(course.id)" class="forum-btn primary" [style]="{'background': 'var(--primary-color)', 'color': 'var(--text-on-primary)'}">
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="16" height="16" fill="currentColor">
                    <path d="M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/>
                  </svg>
                  Manage
                </button>
                <!-- <button (click)="viewCourseStats(course.id)" class="forum-btn secondary" [style]="{'background': 'var(--secondary-color)', 'color': 'white'}">
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="16" height="16" fill="currentColor">
                    <path d="M19 3H5c-1.11 0-2 .9-2 2v14c0 1.11.89 2 2 2h14c1.11 0 2-.89 2-2V5c0-1.11-.89-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
                  </svg>
                </button> -->
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Recent Activity Section -->
  <div *ngIf="!loading && recentPosts.length > 0" class="activity-section">
    <div class="section-container" [style]="{'background': 'var(--card-bg)', 'border': '1px solid var(--border-color)'}">
      <div class="section-header" [style]="{'background': 'var(--warning-color)', 'color': 'white'}">
        <div class="section-title">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24" fill="currentColor">
            <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
          </svg>
          <span>Recent Student Activity</span>
        </div>
        <button class="view-all-btn" [style]="{'color': 'white'}">View All Activity</button>
      </div>
      
      <div class="section-content">
        <div class="activity-list">
          <div *ngFor="let post of recentPosts; let i = index" class="activity-item" [style]="{'border-bottom': i < recentPosts.length - 1 ? '1px solid var(--border-color)' : 'none'}">
            <div class="activity-avatar">
              <img *ngIf="getPostAuthorProfile(post)" [src]="getPostAuthorProfile(post)" [alt]="getPostAuthor(post)">
              <div *ngIf="!getPostAuthorProfile(post)" class="default-avatar" [style]="{'background': 'var(--primary-color)', 'color': 'var(--text-on-primary)'}">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="16" height="16" fill="currentColor">
                  <path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/>
                </svg>
              </div>
            </div>
            
            <div class="activity-content">
              <div class="activity-header">
                <span class="activity-author" [style]="{'color': 'var(--text-color)'}">{{ getPostAuthor(post) }}</span>
                <span class="activity-time" [style]="{'color': 'var(--text-muted)'}">{{ getTimeAgo(post.created_at) }}</span>
                <span *ngIf="post.is_new" class="new-badge" [style]="{'background': 'var(--danger-color)', 'color': 'white'}">New</span>
              </div>
              
              <p class="activity-body" [style]="{'color': 'var(--text-color)'}">{{ post.content }}</p>
              
              <div class="activity-meta">
                <span class="activity-course" [style]="{'color': 'var(--text-muted)'}">
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="14" height="14" fill="currentColor">
                    <path d="M10 4H4c-1.11 0-2 .89-2 2v12c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V8c0-1.11-.89-2-2-2h-8l-2-2z"/>
                  </svg>
                  {{ post.course_name || post.topic_title }}
                </span>
                <div class="activity-actions">
                  <button (click)="moderatePost(post)" class="activity-action" [style]="{'color': 'var(--warning-color)'}">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="14" height="14" fill="currentColor">
                      <path d="M12 15.5A3.5 3.5 0 0 1 8.5 12A3.5 3.5 0 0 1 12 8.5a3.5 3.5 0 0 1 3.5 3.5 3.5 3.5 0 0 1-3.5 3.5m7.43-2.53c.04-.32.07-.64.07-.97 0-.33-.03-.66-.07-1l2.11-1.63c.19-.15.24-.42.12-.64l-2-3.46c-.12-.22-.39-.31-.61-.22l-2.49 1c-.52-.39-1.06-.73-1.69-.98l-.37-2.65A.506.506 0 0 0 14 2h-4c-.25 0-.46.18-.5.42l-.37 2.65c-.63.25-1.17.59-1.69.98l-2.49-1c-.22-.09-.49 0-.61.22l-2 3.46c-.13.22-.07.49.12.64L4.57 11c-.04.34-.07.67-.07 1 0 .33.03.65.07.97l-2.11 1.66c-.19.15-.25.42-.12.64l2 3.46c.12.22.39.3.61.22l2.49-1.01c.52.4 1.06.74 1.69.99l.37 2.65c.04.24.25.42.5.42h4c.25 0 .46-.18.5-.42l.37-2.65c.63-.26 1.17-.59 1.69-.99l2.49 1.01c.22.08.49 0 .61-.22l2-3.46c.12-.22.07-.49-.12-.64l-2.11-1.66Z"/>
                    </svg>
                    Moderate
                  </button>
                  <button (click)="replyToPost(post)" class="activity-action" [style]="{'color': 'var(--primary-color)'}">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="14" height="14" fill="currentColor">
                      <path d="M10 9V5l-7 7 7 7v-4.1c5 0 8.5 1.6 11 5.1-1-5-4-10-11-11z"/>
                    </svg>
                    Reply
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Moderation Guidelines Section -->
  <div *ngIf="!loading" class="guidelines-section">
    <div class="section-container" [style]="{'background': 'var(--alert-warning-bg)', 'border': '1px solid var(--alert-warning-border)'}">
      <div class="guidelines-header">
        <h3 [style]="{'color': 'var(--text-color)'}">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="20" height="20" fill="currentColor" [style]="{'color': 'var(--warning-color)'}">
            <path d="M12,1L3,5V11C3,16.55 6.84,21.74 12,23C17.16,21.74 21,16.55 21,11V5L12,1M12,7C13.4,7 14.8,8.6 14.8,10V11.5C14.8,12.4 14.4,13.2 13.7,13.7V16.5C13.7,17.3 13.1,18 12.3,18H11.7C10.9,18 10.3,17.3 10.3,16.5V13.7C9.6,13.2 9.2,12.4 9.2,11.5V10C9.2,8.6 10.6,7 12,7Z"/>
          </svg>
          Moderation Tools & Guidelines
        </h3>
      </div>
      
      <div class="guidelines-content">
        <div class="guidelines-grid">
          <div class="guideline-section">
            <h4 [style]="{'color': 'var(--text-color)'}">Available Actions:</h4>
            <div class="guideline-list">
              <div class="guideline-item">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="16" height="16" fill="currentColor" [style]="{'color': 'var(--primary-color)'}">
                  <path d="M16,12V4H17V2H7V4H8V12L6,14V16H11.2V22H12.8V16H18V14L16,12Z"/>
                </svg>
                <span [style]="{'color': 'var(--text-color)'}">Pin important threads</span>
              </div>
              <div class="guideline-item">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="16" height="16" fill="currentColor" [style]="{'color': 'var(--primary-color)'}">
                  <path d="M12,17A2,2 0 0,0 14,15C14,13.89 13.1,13 12,13A2,2 0 0,0 10,15A2,2 0 0,0 12,17M18,8A2,2 0 0,1 20,10V20A2,2 0 0,1 18,22H6A2,2 0 0,1 4,20V10C4,8.89 4.9,8 6,8H7V6A5,5 0 0,1 12,1A5,5 0 0,1 17,6V8H18M12,3A3,3 0 0,0 9,6V8H15V6A3,3 0 0,0 12,3Z"/>
                </svg>
                <span [style]="{'color': 'var(--text-color)'}">Lock completed discussions</span>
              </div>
              <div class="guideline-item">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="16" height="16" fill="currentColor" [style]="{'color': 'var(--primary-color)'}">
                  <path d="M20.71,7.04C21.1,6.65 21.1,6 20.71,5.63L18.37,3.29C18,2.9 17.35,2.9 16.96,3.29L15.12,5.12L18.87,8.87M3,17.25V21H6.75L17.81,9.93L14.06,6.18L3,17.25Z"/>
                </svg>
                <span [style]="{'color': 'var(--text-color)'}">Edit or delete posts</span>
              </div>
              <div class="guideline-item">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="16" height="16" fill="currentColor" [style]="{'color': 'var(--primary-color)'}">
                  <path d="M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/>
                </svg>
                <span [style]="{'color': 'var(--text-color)'}">Monitor student activity</span>
              </div>
            </div>
          </div>
          
          <div class="guideline-section">
            <h4 [style]="{'color': 'var(--text-color)'}">Best Practices:</h4>
            <div class="guideline-list">
              <div class="guideline-item">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="16" height="16" fill="currentColor" [style]="{'color': 'var(--success-color)'}">
                  <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/>
                </svg>
                <span [style]="{'color': 'var(--text-color)'}">Respond to student questions promptly</span>
              </div>
              <div class="guideline-item">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="16" height="16" fill="currentColor" [style]="{'color': 'var(--success-color)'}">
                  <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/>
                </svg>
                <span [style]="{'color': 'var(--text-color)'}">Encourage constructive peer discussions</span>
              </div>
              <div class="guideline-item">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="16" height="16" fill="currentColor" [style]="{'color': 'var(--success-color)'}">
                  <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/>
                </svg>
                <span [style]="{'color': 'var(--text-color)'}">Set clear discussion guidelines</span>
              </div>
              <div class="guideline-item">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="16" height="16" fill="currentColor" [style]="{'color': 'var(--success-color)'}">
                  <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/>
                </svg>
                <span [style]="{'color': 'var(--text-color)'}">Use pins for important announcements</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>